<!DOCTYPE html>
<html lang='zh-CN'>


<head>
  <meta charset="utf-8">
  <meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.25.0" theme-name="Stellar" theme-version="1.25.0">
  
  <meta name="generator" content="Hexo 7.1.1">
  <meta http-equiv='x-dns-prefetch-control' content='on' />
  
  <meta name="renderer" content="webkit">
  <meta name="force-rendering" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="HandheldFriendly" content="True" >
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="theme-color" content="#f8f8f8">
  
  <title>汇编语言：标志寄存器和JCC指令 - Misc0101</title>

  
    <meta name="description" content="EFLAGS寄存器  《白皮书一卷》3.4.3 EFLAGS Register P77   DF Flag The direction flag (DF, located in bit 10 of the EFLAGS register) controls string instructions (MOVS, CMPS, SCAS, LODS, and STOS). The STD and CL">
<meta property="og:type" content="website">
<meta property="og:title" content="标志寄存器和JCC指令">
<meta property="og:url" content="https://misc0101.github.io/wiki/Assembly_Language/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8CJCC%E6%8C%87%E4%BB%A4.html">
<meta property="og:site_name" content="Misc0101">
<meta property="og:description" content="EFLAGS寄存器  《白皮书一卷》3.4.3 EFLAGS Register P77   DF Flag The direction flag (DF, located in bit 10 of the EFLAGS register) controls string instructions (MOVS, CMPS, SCAS, LODS, and STOS). The STD and CL">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://misc0101.github.io/Typora_images/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8CJCC%E6%8C%87%E4%BB%A4/20170728114001750.png">
<meta property="og:image" content="https://misc0101.github.io/Typora_images/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8CJCC%E6%8C%87%E4%BB%A4/image-20230923155546076.png">
<meta property="article:published_time" content="2023-09-20T06:39:09.000Z">
<meta property="article:modified_time" content="2023-09-20T06:39:09.000Z">
<meta property="article:author" content="Misc0101">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://misc0101.github.io/Typora_images/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8CJCC%E6%8C%87%E4%BB%A4/20170728114001750.png">
  
  
  
  

  <!-- feed -->
  

  
    
<link rel="stylesheet" href="/css/main.css">

  

  

  

  
  
</head>

<body>
  




  <div class='l_body' id='start'>
    <aside class='l_left' layout='wiki'>
    

  




<div class="widgets"><widget class="widget-wrapper logo-wrap wiki"><div class="widget-body"><a style="filter: grayscale(100%)" class="wiki-home cap" href="/wiki"><svg aria-hidden="true" viewBox="0 0 16 16" width="1.2em" height="1.2em" fill="currentColor"><path fill-rule="evenodd" d="M7.78 12.53a.75.75 0 01-1.06 0L2.47 8.28a.75.75 0 010-1.06l4.25-4.25a.75.75 0 011.06 1.06L4.81 7h7.44a.75.75 0 010 1.5H4.81l2.97 2.97a.75.75 0 010 1.06z"></path></svg>所有项目</a><a class="title" href="/wiki/Assembly_Language/%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8_%E5%86%85%E5%AD%98%E8%AF%BB%E5%86%99.html"><div class="main" ff="title">汇编语言</div></a></div></widget>
<widget class="widget-wrapper search"><div class="widget-body"><div class="search-wrapper" id="search-wrapper"><form class="search-form"><input type="text" class="search-input" id="search-input" data-filter="/wiki/Assembly_Language/" placeholder="在/wiki/Assembly_Language/中搜索..."><svg t="1705074644177" class="icon search-icon" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div></div></widget>


<widget class="widget-wrapper toc multi" id="data-toc" collapse="false"><div class="widget-body fs14"><div class="doc-tree"><a class="doc-tree-link" href="/wiki/Assembly_Language/%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8_%E5%86%85%E5%AD%98%E8%AF%BB%E5%86%99.html#start"><span class="toc-text">通用寄存器_内存读写</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/Assembly_Language/%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4.html"><span class="toc-text">汇编指令</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/Assembly_Language/%E8%BF%87%E7%A8%8B.html"><span class="toc-text">过程</span></a></div><div class="doc-tree active"><a class="doc-tree-link active" href="/wiki/Assembly_Language/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8CJCC%E6%8C%87%E4%BB%A4.html"><span class="toc-text">标志寄存器和JCC指令</span></a><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#eflags%E5%AF%84%E5%AD%98%E5%99%A8"><span class="toc-text"> EFLAGS寄存器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cf-bit-0-carry-flag"><span class="toc-text"> CF (bit 0) Carry flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pf-bit-2-parity-flag"><span class="toc-text"> PF (bit 2) Parity flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#af-bit-4-auxiliary-carry-flag"><span class="toc-text"> AF (bit 4) Auxiliary Carry flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zf-bit-6-zero-flag"><span class="toc-text"> ZF (bit 6) Zero flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sf-bit-7-sign-flag"><span class="toc-text"> SF (bit 7) Sign flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#of-bit-11-overflow-flag"><span class="toc-text"> OF (bit 11) Overflow flag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%9C%E4%B8%9A"><span class="toc-text"> 作业</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E6%8C%87%E4%BB%A4"><span class="toc-text"> 比较指令</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cmp"><span class="toc-text"> CMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#test"><span class="toc-text"> TEST</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jccjump-if-condition-is-met"><span class="toc-text"> Jcc—Jump if Condition Is Met</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E8%A7%88%E8%A1%A8"><span class="toc-text"> 一览表</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E8%B7%B3%E8%BD%AC%E6%8C%87%E4%BB%A4%E7%B1%BB%E5%9E%8B"><span class="toc-text"> 条件跳转指令类型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E7%89%B9%E5%AE%9A%E6%A0%87%E5%BF%97%E4%BD%8D%E5%80%BC%E7%9A%84%E8%B7%B3%E8%BD%AC"><span class="toc-text"> 基于特定标志位值的跳转</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E7%AD%89%E6%80%A7%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-text"> 相等性的比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E7%AC%A6%E5%8F%B7%E6%95%B0%E6%AF%94%E8%BE%83"><span class="toc-text"> 无符号数比较</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E7%AC%A6%E5%8F%B7%E6%95%B0%E6%AF%94%E8%BE%83"><span class="toc-text"> 有符号数比较</span></a></li></ol></li></ol></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/Assembly_Language/%E5%A0%86%E6%A0%88%E5%9B%BE.html"><span class="toc-text">堆栈图</span></a></div><div class="doc-tree"><a class="doc-tree-link" href="/wiki/Assembly_Language/%E5%B0%8F%E7%BB%93_assembly.html"><span class="toc-text">小结</span></a></div></div></widget>

<widget class="widget-wrapper related"><div class="widget-header cap theme dis-select"><span class="name">更多：计算机基础</span></div><div class="widget-body related-posts"><a class="item wiki" href="/wiki/C++/%E5%B0%81%E8%A3%85%E5%92%8Cthis%E6%8C%87%E9%92%88.html"><span class="title">C++</span><span class="excerpt">滴水三期_C++语言笔记，C++能做的C都能做，只不过如果使用C++，可以节省很多时间，因为编译器帮编程人员做了很多工作，让编程人员省事。学习的目标：相对于C，编译器替我们做了哪些工作。</span></a><a class="item wiki" href="/wiki/C/%E5%87%BD%E6%95%B0.html"><span class="title">C</span><span class="excerpt">滴水三期_C语言笔记，以逆向角度看待和学习C语言，精彩点：堆栈图与指针。</span></a><a class="item wiki" href="/wiki/Modern_C++/%E7%B1%BB.html"><span class="title">Modern C++</span><span class="excerpt">C++98及其之前的C++ 特性称之为traditional C++（传统C++），C++11/14/17/20被称为Modern C++（现代 C++ ）。补充从传统C++“升级”到现代C++的知识。</span></a><a class="item wiki" href="/wiki/Proxy_Protocols/%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86_%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E6%8A%80%E6%9C%AF.html"><span class="title">科学上网技术</span><span class="excerpt">从正常网络通信数据包通信过程出发，逐步推导到使用代理协议进行科学上网，随后依次介绍各代理协议ss、trojan、vmess、vless原理与节点搭建，还有相关的工具、技术、概念介绍。</span></a><a class="item wiki" href="/wiki/Thinking_in_C++/Pointers.html"><span class="title">Thinking in C++</span><span class="excerpt">《Thinking in C++ vol 1》笔记，知识内化后的输出，少部分是摘抄，少用的细节不做记录用时在查，参考视频：《面向对象程序设计_C++_翁恺老师》。</span></a><a class="item wiki" href="/wiki/Windows_API/%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81.html"><span class="title">Windows API编程</span><span class="excerpt">滴水三期_win32 api笔记，学习Windows API编程的困难并不在于函数参数参数众多或者英文不好这类表象原因，而是需要从Windows系统的整体知识架构出发来学习这些API，深入理解每个参数背后的含义和背景。如此，未来查阅MSDN时便不再像是看天书。</span></a><a class="item wiki" href="/wiki/representation_and_computation_of_data/%E8%BF%9B%E5%88%B6.html"><span class="title">数据的运算与表示</span><span class="excerpt">滴水三期_进制笔记，学习与理解进制、数据宽度、数的表示、位运算等概念。</span></a></div></widget>
</div>


    </aside>
    <div class='l_main'>
      
  





      


<div class="bread-nav fs12"><div class="left"><div id="breadcrumb"><a class="cap breadcrumb" id="home" href="/">主页</a><span class="sep"></span><a class="cap breadcrumb" id="menu" href="/wiki/">项目</a><span class="sep"></span><a class="cap breadcrumb" id="proj" href="/wiki/Assembly_Language/%E9%80%9A%E7%94%A8%E5%AF%84%E5%AD%98%E5%99%A8_%E5%86%85%E5%AD%98%E8%AF%BB%E5%86%99.html">汇编语言</a></div><div id="post-meta">
    <span>更新于&nbsp;<time datetime="2023-09-20T06:39:09.000Z">2023-09-20</time></span>
    </div></div></div>

<article class='md-text content wiki'>
<h1 class="article-title"><span>标志寄存器和JCC指令</span></h1>
<h2 id="eflags寄存器"><a class="markdownIt-Anchor" href="#eflags寄存器"></a> EFLAGS寄存器</h2>
<blockquote>
<p>《白皮书一卷》3.4.3 EFLAGS Register P77</p>
</blockquote>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/../Typora_images/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8CJCC%E6%8C%87%E4%BB%A4/20170728114001750.png" alt="img" /></p>
<p><strong>DF Flag</strong></p>
<p>The direction flag (DF, located in bit 10 of the EFLAGS register) controls string instructions (MOVS, CMPS, SCAS,</p>
<p>LODS, and STOS).</p>
<p>The STD and CLD instructions set and clear the DF flag, respectively</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CLD;方向标志位清零（正向）</span><br><span class="line">STD;方向标志位置1（反向）</span><br></pre></td></tr></table></figure>
<p>Setting the DF flag causes the string instructions to auto-decrement (to process strings from high addresses to low addresses). Clearing the DF flag causes the string instructions to auto-increment (process strings from low addresses to high addresses).</p>
<table>
<thead>
<tr>
<th>方向标志位的值</th>
<th>对ESI和EDI的影响</th>
<th>地址顺序</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>增加</td>
<td>低到高</td>
</tr>
<tr>
<td>1</td>
<td>减少</td>
<td>高到低</td>
</tr>
</tbody>
</table>
</br>
<p><strong>Status Flags</strong></p>
<p>The status flags (bits 0, 2, 4, 6, 7, and 11) of the EFLAGS register indicate the results of arithmetic instructions,</p>
<p>such as the ADD, SUB, MUL, and DIV instructions. The status flag functions are:</p>
<h3 id="cf-bit-0-carry-flag"><a class="markdownIt-Anchor" href="#cf-bit-0-carry-flag"></a> CF (bit 0) Carry flag</h3>
<p>若算术操作产生的结果在**最高有效位(most-significant bit)**发生进位或借位则将其置1，反之清零。</p>
<p>这个标志通常用来指示无符号整型运算的溢出状态。</p>
<p>进位</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,0xFE</span><br><span class="line">add al,2</span><br></pre></td></tr></table></figure>
<p>借位</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,0x7F</span><br><span class="line">sub al,0xFF</span><br></pre></td></tr></table></figure>
<p>但其实负数也是用补码表示，减法就是加法，所以不存在借位的说法</p>
<h3 id="pf-bit-2-parity-flag"><a class="markdownIt-Anchor" href="#pf-bit-2-parity-flag"></a> PF (bit 2) Parity flag</h3>
<p>如果结果的<u>最低有效字节(least-significant byte)</u>包含偶数个1位则该位置1，否则清零。</p>
<blockquote>
<ul>
<li>在字操作时，最低有效字节就是低8位</li>
<li>在字节操作时，最低有效字节就是低4位</li>
</ul>
</blockquote>
<p>用途：网络传输中的奇偶校验检查。假设需要传输&quot;11001110&quot;，数据中含5个&quot;1&quot;，所以其奇校验位为&quot;0&quot;，同时把&quot;110011100&quot;传输给接收方，接收方收到数据后再一次计算奇偶性，“110011100&quot;中仍然含有5个&quot;1”，所以接收方计算出的奇校验位还是&quot;0&quot;，与发送方一致，表示在此次传输过程中未发生错误。</p>
<p>一个例子证明最低有效字节(least-significant byte)指哪部分：113+1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ax,113</span><br><span class="line">add ax,1</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0000</span> <span class="number">0001</span> <span class="number">0001</span> <span class="number">0011</span>   AX</span><br><span class="line"></span><br><span class="line"><span class="number">0000</span> <span class="number">0000</span> <span class="number">0000</span> <span class="number">0001</span>   <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">0000</span> <span class="number">0001</span> <span class="number">0001</span> <span class="number">0100</span>   AX+<span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>看AX+1，如果最低有效位是以字节来看，那就是0001  0100，两个；如果是以字来看，那就是0000  0001  0001  0100，3个1。</p>
<p>执行上面两条指令后，PF=1，说明最低有效字节(least-significant byte)就是指这个数字最后的一个字节。</p>
<h3 id="af-bit-4-auxiliary-carry-flag"><a class="markdownIt-Anchor" href="#af-bit-4-auxiliary-carry-flag"></a> AF (bit 4) Auxiliary Carry flag</h3>
<p>— Set if an arithmetic operation generates a carry or a borrow <u>out of bit 3 of the result</u>; cleared otherwise. This flag is used in binary-coded decimal (BCD) arithmetic.</p>
<p>如果算术操作在结果的第3位发生进位或借位则将该标志置1，否则清零。这个标志在BCD(binary-code decimal)算术运算中被使用。</p>
<hr />
<p>上面是原文，网上资料的是：表示加减法做到一半时有没有形成进位/借位，如果有则AF=1</p>
<ul>
<li>在字操作时，发生低字节向高字节进位或借位时；</li>
<li>在字节操作时，发生低4位向高4位进位或借位时。</li>
</ul>
<p>双字进位例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov eax,0x55EEFFFF</span><br><span class="line">add eax,2</span><br></pre></td></tr></table></figure>
<p>字进位例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov ax,5ffe</span><br><span class="line">add ax,2</span><br></pre></td></tr></table></figure>
<p>字节进位例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,4e</span><br><span class="line">add al,2</span><br></pre></td></tr></table></figure>
<h3 id="zf-bit-6-zero-flag"><a class="markdownIt-Anchor" href="#zf-bit-6-zero-flag"></a> ZF (bit 6) Zero flag</h3>
<p>— Set if the result is zero; cleared otherwise.</p>
<p>常与CMP和TEST等指令一起使用。</p>
<h3 id="sf-bit-7-sign-flag"><a class="markdownIt-Anchor" href="#sf-bit-7-sign-flag"></a> SF (bit 7) Sign flag</h3>
<p>该标志被设置为有符号整型的最高有效位。(0指示结果为正，反之则为负)</p>
<p>例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov al,0x7F</span><br><span class="line">add al,2</span><br><span class="line">;执行后SF=0，负数</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov al,0xFE</span><br><span class="line">add al,2</span><br><span class="line">;执行后SF=1，正数</span><br></pre></td></tr></table></figure>
<h3 id="of-bit-11-overflow-flag"><a class="markdownIt-Anchor" href="#of-bit-11-overflow-flag"></a> OF (bit 11) Overflow flag</h3>
<p>— Set if the integer result is too large a positive number or too small a negative number (excluding the sign-bit) to fit in the destination operand; cleared otherwise. This flag indicates an overflow condition for signed-integer (two’s complement) arithmetic.</p>
<p>用于反映有符号数加减运算所得结果是否溢出。</p>
<p>例子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mov al,0x7F</span><br><span class="line">add al,2</span><br><span class="line">;执行后OF=1，溢出</span><br></pre></td></tr></table></figure>
<p>如果是无符号数运算，是否溢出看CF位；如果是有符号数运算，是否溢出看OF位。</p>
<p>溢出主要是给有符号运算使用的，在有符号的运算中，有如下的规律:</p>
<p>正＋正=正，但如果结果是负数，则说明有溢出<br />
负＋负=负，但如果结果是正数，则说明有溢出</p>
<p>正＋负，永远都不会有溢出。比如<code>add al,3</code>，8位有符号数所能表示的范围是-128-127，极端情况，最大的正数+最小的负数，127+（-1），不会溢出</p>
<hr />
<p>海哥的讲法：</p>
<p><img class="lazy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAABGdBTUEAALGPC/xhBQAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAAaADAAQAAAABAAAAAQAAAADa6r/EAAAAC0lEQVQIHWNgAAIAAAUAAY27m/MAAAAASUVORK5CYII=" data-src="/../Typora_images/%E6%A0%87%E5%BF%97%E5%AF%84%E5%AD%98%E5%99%A8%E5%92%8CJCC%E6%8C%87%E4%BB%A4/image-20230923155546076.png" alt="image-20230923155546076" /></p>
<p>还是看这个圈，<u>相加看成是往后查多少个数，绕圈转</u>。</p>
<ul>
<li>如果是无符号数，范围0-FF，两数运算，超过FF就是溢出</li>
<li>如果是有符号数，正数0-7F，负数80-FF。
<ul>
<li>两正数相加，但相加时走过7F走到负数的左半圈去了，就是溢出。</li>
<li>负数同理。</li>
<li>正+负，始终不会跑到另一个圈。</li>
</ul>
</li>
</ul>
<p>例子</p>
<ol>
<li>
<p>无符号、有符号都不溢出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,8</span><br><span class="line">add al,8</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>无符号溢出、有符号不溢出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,0ff</span><br><span class="line">add al,2</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>无符号不溢出、有符号溢出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,7f</span><br><span class="line">add al,2</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>无符号、有符号都溢出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,0fe</span><br><span class="line">add al,80</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr />
<p>计算机如何判断是否有溢出</p>
<p>比如80-40</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,80</span><br><span class="line">sub al,40</span><br></pre></td></tr></table></figure>
<p>-40相当于+(-40)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mov al,80</span><br><span class="line">add al,0c0</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1000 0000</span><br><span class="line">1100 0000</span><br><span class="line">---------</span><br></pre></td></tr></table></figure>
<p>符号有进位：1</p>
<p>最高有效数值位向符号位产生的进位：0</p>
<p>1  xor  0  ==1，所以OF=1</p>
<h2 id="作业"><a class="markdownIt-Anchor" href="#作业"></a> 作业</h2>
<ol>
<li>熟练记住CF/PF/AF/ZF/SF/OF在EFLAGS的第几位</li>
</ol>
<h2 id="比较指令"><a class="markdownIt-Anchor" href="#比较指令"></a> 比较指令</h2>
<h3 id="cmp"><a class="markdownIt-Anchor" href="#cmp"></a> CMP</h3>
<p>CMP（比较)指令执行从目的操作数中减去源操作数的隐含减法操作，并且不修改任何操作数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CMP destination,source</span><br></pre></td></tr></table></figure>
<p><strong>标志位</strong>  当实际的减法发生时,CMP指令按照计算结果修改溢出、符号、零、进位、辅助进位和奇偶标志位。</p>
<ul>
<li>
<p>如果比较的是两个无符号数,则零标志位和进位标志位表示的两个操作数之间的关系如下表所示:</p>
<table>
<thead>
<tr>
<th>CMP结果</th>
<th>ZF</th>
<th>CF</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>目的操作数＜源操作数</td>
<td>0</td>
<td>1</td>
<td>因为＜，不够减，发生了借位，CF=1</td>
</tr>
<tr>
<td>目的操作数＞源操作数</td>
<td>0</td>
<td>0</td>
<td>够减，没借位，CF=0</td>
</tr>
<tr>
<td>目的操作数＝源操作数</td>
<td>1</td>
<td>0</td>
<td>一样大，结果=0，ZF=1</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>如果比较的是两个有符号数,则符号标志位、零标志位和溢出标志位表示的两个操作数之间的关系如下表所示:</p>
<table>
<thead>
<tr>
<th>CMP结果</th>
<th>标志位</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>目的操作数＜源操作数</td>
<td>SF≠OF</td>
<td></td>
</tr>
<tr>
<td>目的操作数＞源操作数</td>
<td>SF=OF</td>
<td></td>
</tr>
<tr>
<td>目的操作数＝源操作数</td>
<td>ZF=1</td>
<td>一样大，结果=0，ZF=1</td>
</tr>
</tbody>
</table>
</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>目的操作数＜源操作数（不够减）</th>
<th>目的操作数＞源操作数（够减）</th>
</tr>
</thead>
<tbody>
<tr>
<td>正-正&lt;=&gt;正+负</td>
<td>比如2-3，结果为负，SF=1。正+负不会有溢出，OF=0</td>
<td>比如3-2，结果为正，SF=0。没有溢出，OF=0</td>
</tr>
<tr>
<td>正-负&lt;=&gt;正+正</td>
<td></td>
<td></td>
</tr>
<tr>
<td>负-正&lt;=&gt;正+负</td>
<td></td>
<td></td>
</tr>
<tr>
<td>负-负&lt;=&gt;正+负</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<p>这里不分析了，JCC死记硬背就好了</p>
<p>SF表示有符号整型的最高有效位。(0指示结果为正，反之则为负)</p>
<p>OF用于反映有符号数加减运算所得结果是否溢出</p>
<hr />
<p>正＋正=正，但如果结果是负数，则说明有溢出<br />
负＋负=负，但如果结果是正数，则说明有溢出</p>
<p>正＋负，永远都不会有溢出</p>
</blockquote>
<h3 id="test"><a class="markdownIt-Anchor" href="#test"></a> TEST</h3>
<p>TEST指令在两个操作数的对应位之间进行AND操作，并根据运算结果设置符号标志位、零标志位和奇偶标志位。TEST指令与AND指令唯一不同的地方是，TEST指令不修改目标操作数。</p>
<p>TEST指令允许的操作数组合与AND指令相同。</p>
<p><strong>用途</strong>  在发现操作数中单个位是否置位（是否是0）时,TEST指令非常有用。</p>
<p><strong>标志位</strong>  TEST指令总是清除溢出和进位标志位，其修改符号标志位、零标志位和奇偶标志位的方法与AND指令相同。</p>
<h2 id="jccjump-if-condition-is-met"><a class="markdownIt-Anchor" href="#jccjump-if-condition-is-met"></a> Jcc—Jump if Condition Is Met</h2>
<blockquote>
<p>《白皮书二卷》Jcc—Jump if Condition Is Met小节P660</p>
</blockquote>
<p>Checks the state of one or more of the status flags in the EFLAGS register (CF, OF, PF, SF, and ZF) and, if the flags</p>
<p>are in the specified state (condition), performs a jump to the target instruction specified by the destination</p>
<p>operand. A condition code (cc) is associated with each instruction to indicate the condition being tested for. If the condition is not satisfied, the jump is not performed and execution continues with the instruction following the Jcc instruction.</p>
<p>当执行jcc指令时，jcc指令就是根据标志位相应的值，选择跳转，或继续执行。虽然通常使用比较和跳转的组合来实现条件结构，但别习惯了它们必须成对出现，我可以这里有一行CMP，然后中间修改了标志位，导致我用JZ跳转时看的ZF位已不是由CMP那行决定的。（好像有点废话，感觉这一点不需要记笔记）</p>
<h3 id="一览表"><a class="markdownIt-Anchor" href="#一览表"></a> 一览表</h3>
<table>
<thead>
<tr>
<th>JCC指令</th>
<th>中文含义</th>
<th>英文原意</th>
<th>检查符号位</th>
<th>典型c应用</th>
</tr>
</thead>
<tbody>
<tr>
<td>JZ/JE</td>
<td>若为0则跳转；若相等则跳转</td>
<td>jump if zero;jump if equal</td>
<td>ZF=1</td>
<td>if (i == j);if (i == 0);</td>
</tr>
<tr>
<td>JNZ/JNE</td>
<td>若不为0则跳转；若不相等则跳转</td>
<td>jump if not zero;jump if not equal</td>
<td>ZF=0</td>
<td>if (i != j);if (i != 0);</td>
</tr>
<tr>
<td>JS</td>
<td>若为负则跳转</td>
<td>jump if sign</td>
<td>SF=1</td>
<td>if (i &lt; 0);</td>
</tr>
<tr>
<td>JNS</td>
<td>若为正则跳转</td>
<td>jump if not sign</td>
<td>SF=0</td>
<td>if (i &gt; 0);</td>
</tr>
<tr>
<td>JP/JPE</td>
<td>若1出现次数为偶数则跳转</td>
<td>jump if Parity (Even)</td>
<td>PF=1</td>
<td>(null)</td>
</tr>
<tr>
<td>JNP/JPO</td>
<td>若1出现次数为奇数则跳转</td>
<td>jump if not parity (odd)</td>
<td>PF=0</td>
<td>(null)</td>
</tr>
<tr>
<td>JO</td>
<td>若溢出则跳转</td>
<td>jump if overflow</td>
<td>OF=1</td>
<td>(null)</td>
</tr>
<tr>
<td>JNO</td>
<td>若无溢出则跳转</td>
<td>jump if not overflow</td>
<td>OF=0</td>
<td>(null)</td>
</tr>
<tr>
<td>JC/JB/JNAE</td>
<td>若进位则跳转；若低于则跳转；若不高于等于则跳转</td>
<td>jump if carry;jump if below;jump if not above equal</td>
<td>CF=1</td>
<td>if (i &lt; j);</td>
</tr>
<tr>
<td>JNC/JNB/JAE</td>
<td>若无进位则跳转；若不低于则跳转；若高于等于则跳转</td>
<td>jump if not carry;jump if not below;jump if above equal</td>
<td>CF=0</td>
<td>if (i &gt;= j);</td>
</tr>
<tr>
<td>JBE/JNA</td>
<td>若低于等于则跳转；若不高于则跳转</td>
<td>jump if below equal;jump if not above</td>
<td>ZF=1或CF=1</td>
<td>if (i &lt;= j);</td>
</tr>
<tr>
<td>JNBE/JA</td>
<td>若不低于等于则跳转；若高于则跳转</td>
<td>jump if not below equal;jump if above</td>
<td>ZF=0或CF=0</td>
<td>if (i &gt; j);</td>
</tr>
<tr>
<td>JL/JNGE</td>
<td>若小于则跳转；若不大于等于则跳转</td>
<td>jump if less;jump if not greater equal</td>
<td>SF != OF</td>
<td>if (si &lt; sj);</td>
</tr>
<tr>
<td>JNL/JGE</td>
<td>若不小于则跳转；若大于等于则跳转</td>
<td>jump if not less;jump if greater equal</td>
<td>SF=OF</td>
<td>if (si &gt;= sj);</td>
</tr>
<tr>
<td>JLE/JNG</td>
<td>若小于等于则跳转；若不大于则跳转</td>
<td>jump if less equal;jump if not greater</td>
<td>ZF != OF 或 ZF=1</td>
<td>if (si &lt;= sj);</td>
</tr>
<tr>
<td>JNLE/JG</td>
<td>若不小于等于则跳转；若大于则跳转</td>
<td>jump if not less equal;jump if greater</td>
<td>SF=OF 且 ZF=0</td>
<td>if(si&gt;sj)</td>
</tr>
</tbody>
</table>
<h2 id="条件跳转指令类型"><a class="markdownIt-Anchor" href="#条件跳转指令类型"></a> 条件跳转指令类型</h2>
<blockquote>
<p>《汇编语言-基于x86处理器第七版》P157</p>
</blockquote>
<h3 id="基于特定标志位值的跳转"><a class="markdownIt-Anchor" href="#基于特定标志位值的跳转"></a> 基于特定标志位值的跳转</h3>
<table>
<thead>
<tr>
<th>助记符</th>
<th>说明</th>
<th>标志位/寄存器</th>
<th></th>
<th>助记符</th>
<th>说明</th>
<th>标志位/寄存器</th>
</tr>
</thead>
<tbody>
<tr>
<td>JZ</td>
<td>为零跳转</td>
<td>ZF=1</td>
<td></td>
<td>JNO</td>
<td>无溢出跳转</td>
<td>OF=0</td>
</tr>
<tr>
<td>JNZ</td>
<td>非零跳转</td>
<td>ZF=0</td>
<td></td>
<td>JS</td>
<td>有符号跳转</td>
<td>SF=1</td>
</tr>
<tr>
<td>JC</td>
<td>进位跳转</td>
<td>CF=1</td>
<td></td>
<td>JNS</td>
<td>无符号跳转</td>
<td>SF=0</td>
</tr>
<tr>
<td>JNC</td>
<td>无进位跳转</td>
<td>CF=0</td>
<td></td>
<td>JP</td>
<td>偶校验跳转</td>
<td>PF=1</td>
</tr>
<tr>
<td>JO</td>
<td>溢出跳转</td>
<td>OF=1</td>
<td></td>
<td>JNP</td>
<td>奇校验跳转</td>
<td>PF=0</td>
</tr>
</tbody>
</table>
<h3 id="相等性的比较"><a class="markdownIt-Anchor" href="#相等性的比较"></a> 相等性的比较</h3>
<table>
<thead>
<tr>
<th>助记符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>JE</td>
<td>相等跳转（leftOp=rightOp）</td>
</tr>
<tr>
<td>JNE</td>
<td>不相等跳转（leftOp≠rightOp）</td>
</tr>
<tr>
<td>JCXZ</td>
<td>CX=0跳转</td>
</tr>
<tr>
<td>JECXZ</td>
<td>ECX=0跳转</td>
</tr>
<tr>
<td>JRCXZ</td>
<td>RCX=0跳转（64位模式）</td>
</tr>
</tbody>
</table>
<ul>
<li>尽管JE指令相当于JZ(为零跳转)，JNE指令相当于JNZ(非零跳转)，但是，<u>最好是选择最能表明编程意图的助记符(JE或JZ),以便说明是比较两个操作数还是检查特定的状态标志位。</u></li>
</ul>
<h3 id="无符号数比较"><a class="markdownIt-Anchor" href="#无符号数比较"></a> 无符号数比较</h3>
<table>
<thead>
<tr>
<th>助记符</th>
<th>说明</th>
<th></th>
<th>助记符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>JA</td>
<td>大于跳转（若leftOp＞rightOp）</td>
<td></td>
<td>JB</td>
<td>小于跳转（若leftOp＜rightOp）</td>
</tr>
<tr>
<td>JNBE</td>
<td>不小于或等于跳转（与JA相同）</td>
<td></td>
<td>JNAE</td>
<td>不大于或等于跳转（与JB相同）</td>
</tr>
<tr>
<td>JAE</td>
<td>大于或等于跳转（若leftOp≥rightOp）</td>
<td></td>
<td>JBE</td>
<td>小于或等于跳转（若leftOp≤rightOp）</td>
</tr>
<tr>
<td>JNB</td>
<td>不小于跳转（与JAE相同）</td>
<td></td>
<td>JNA</td>
<td>不大于跳转（与JBE相同）</td>
</tr>
</tbody>
</table>
<h3 id="有符号数比较"><a class="markdownIt-Anchor" href="#有符号数比较"></a> 有符号数比较</h3>
<table>
<thead>
<tr>
<th>助记符</th>
<th>说明</th>
<th></th>
<th>助记符</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>JG</td>
<td>大于跳转（若leftOp＞rightOp）</td>
<td></td>
<td>JL</td>
<td>小于跳转（若leftOp＜rightOp）</td>
</tr>
<tr>
<td>JNLE</td>
<td>不小于或等于跳转（与JG相同）</td>
<td></td>
<td>JNGE</td>
<td>不大于或等于跳转（与JL相同）</td>
</tr>
<tr>
<td>JGE</td>
<td>大于或等于跳转（若leftOp≥rightOp）</td>
<td></td>
<td>JLE</td>
<td>小于或等于跳转（若leftOp≤rightOp）</td>
</tr>
<tr>
<td>JNL</td>
<td>不小于跳转（与JGE相同）</td>
<td></td>
<td>JNG</td>
<td>不大于跳转（与JLE相同）</td>
</tr>
</tbody>
</table>



<div class="article-footer reveal fs14"></div>

</article>

<div class="related-wrap reveal" id="read-next"><section class="body"><div class="item" id="prev"><div class="note">回顾上一篇</div><a href="/wiki/Assembly_Language/%E8%BF%87%E7%A8%8B.html">过程</a></div><div class="item" id="next"><div class="note">接下来阅读</div><a href="/wiki/Assembly_Language/%E5%A0%86%E6%A0%88%E5%9B%BE.html">堆栈图</a></div></section></div>



  <div class='related-wrap md-text reveal' id="comments">
    <section class='header cmt-title cap theme'>
      快来参与讨论吧
    </section>
    <section class='body cmt-body twikoo'>
      

<div id="twikoo_container"><svg class="loading" style="vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg></div>
    </section>
  </div>


      
<footer class="page-footer reveal fs12"><hr><div class="sitemap"><div class="sitemap-group"><span class="fs14">博客</span><a href="/">近期发布</a><a href="/categories/">分类</a><a href="/tags/">标签</a><a href="/archives/">归档</a></div><div class="sitemap-group"><span class="fs14">wiki</span><a href="/wiki/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/">计算机基础</a><a href="/wiki/tags/%E5%AE%89%E5%85%A8%E6%8A%80%E6%9C%AF/">安全技术</a><a href="/wiki/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">环境搭建</a><a href="/wiki/tags/%E5%85%B6%E4%BB%96/">其他</a></div><div class="sitemap-group"><span class="fs14">关于</span><a href="/about/">关于</a></div></div><div class="text"><p>本站由 <a href="/">Misc0101</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.25.0">Stellar 1.25.0</a> 主题创建。<br />
本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p>
</div></footer>

      <div class='float-panel mobile-only blur' style='display:none'>
  <button type='button' class='sidebar-toggle mobile' onclick='sidebar.toggle()'>
    <svg class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15301"><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 2.3 26.8 24.6 47.5 51.6 47.6h416.5v4z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15302"></path><path d="M566.407 808.3c26.9-0.1 49.3-20.8 51.6-47.6-1.9-27.7-23.9-49.7-51.6-51.6h-412.6c-28.2-1.4-52.6 19.5-55.5 47.6 1.9 27.7 23.9 49.7 51.6 51.6h416.5z m309.3-249.9c26.9-0.1 49.3-20.8 51.6-47.6-2.2-26.8-24.6-47.5-51.6-47.6h-721.9c-27.7-2.8-52.5 17.4-55.3 45.1-0.1 0.8-0.1 1.7-0.2 2.5 0.9 27.2 23.6 48.5 50.7 47.6H875.707z m-103.1-245.9c26.9-0.1 49.3-20.8 51.6-47.6-0.4-28.3-23.2-51.1-51.5-51.6h-618.9c-29.5-1.1-54.3 21.9-55.5 51.4v0.2c1.4 27.8 25.2 49.2 53 47.8 0.8 0 1.7-0.1 2.5-0.2h618.8z" p-id="15303"></path></svg>
  </button>
</div>

    </div>
  </div>
  <div class='scripts'>
    
<script type="text/javascript">
  const stellar = {
    // 懒加载 css https://github.com/filamentgroup/loadCSS
    loadCSS: (href, before, media, attributes) => {
      var doc = window.document;
      var ss = doc.createElement("link");
      var ref;
      if (before) {
        ref = before;
      } else {
        var refs = (doc.body || doc.getElementsByTagName("head")[0]).childNodes;
        ref = refs[refs.length - 1];
      }
      var sheets = doc.styleSheets;
      if (attributes) {
        for (var attributeName in attributes) {
          if (attributes.hasOwnProperty(attributeName)) {
            ss.setAttribute(attributeName, attributes[attributeName]);
          }
        }
      }
      ss.rel = "stylesheet";
      ss.href = href;
      ss.media = "only x";
      function ready(cb) {
        if (doc.body) {
          return cb();
        }
        setTimeout(function () {
          ready(cb);
        });
      }
      ready(function () {
        ref.parentNode.insertBefore(ss, before ? ref : ref.nextSibling);
      });
      var onloadcssdefined = function (cb) {
        var resolvedHref = ss.href;
        var i = sheets.length;
        while (i--) {
          if (sheets[i].href === resolvedHref) {
            return cb();
          }
        }
        setTimeout(function () {
          onloadcssdefined(cb);
        });
      };
      function loadCB() {
        if (ss.addEventListener) {
          ss.removeEventListener("load", loadCB);
        }
        ss.media = media || "all";
      }
      if (ss.addEventListener) {
        ss.addEventListener("load", loadCB);
      }
      ss.onloadcssdefined = onloadcssdefined;
      onloadcssdefined(loadCB);
      return ss;
    },

    // 从 butterfly 和 volantis 获得灵感
    loadScript: (src, opt) => new Promise((resolve, reject) => {
      var script = document.createElement('script');
      if (src.startsWith('/')){
        src = stellar.config.root + src.substring(1);
      }
      script.src = src;
      if (opt) {
        for (let key of Object.keys(opt)) {
          script[key] = opt[key]
        }
      } else {
        // 默认异步，如果需要同步，第二个参数传入 {} 即可
        script.async = true
      }
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    }),

    // https://github.com/jerryc127/hexo-theme-butterfly
    jQuery: (fn) => {
      if (typeof jQuery === 'undefined') {
        stellar.loadScript(stellar.plugins.jQuery).then(fn)
      } else {
        fn()
      }
    }
  };
  stellar.version = '1.25.0';
  stellar.github = 'https://github.com/xaoxuu/hexo-theme-stellar/tree/1.25.0';
  stellar.config = {
    date_suffix: {
      just: '刚刚',
      min: '分钟前',
      hour: '小时前',
      day: '天前',
      month: '个月前',
    },
    root : '/',
  };

  // required plugins (only load if needs)
  stellar.plugins = {
    jQuery: 'https://gcore.jsdelivr.net/npm/jquery@3.6.2/dist/jquery.min.js'
  };

  if ('local_search') {
    stellar.search = {};
    stellar.search.service = 'local_search';
    if (stellar.search.service == 'local_search') {
      let service_obj = Object.assign({}, {"field":"all","path":"/search.json","content":true,"sort":"-date"});
      stellar.search[stellar.search.service] = service_obj;
    }
  }

  // stellar js
  stellar.plugins.stellar = Object.assign({"sites":"/js/plugins/sites.js","friends":"/js/plugins/friends.js","ghinfo":"/js/plugins/ghinfo.js","timeline":"/js/plugins/timeline.js","linkcard":"/js/plugins/linkcard.js","fcircle":"/js/plugins/fcircle.js","weibo":"/js/plugins/weibo.js","memos":"/js/plugins/memos.js","marked":"/js/plugins/marked.js"});

  stellar.plugins.marked = Object.assign("https://cdn.bootcdn.net/ajax/libs/marked/4.0.18/marked.min.js");
  // optional plugins
  if ('true' == 'true') {
    stellar.plugins.lazyload = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/vanilla-lazyload@17.8.3/dist/lazyload.min.js","transition":"blur"});
  }
  if ('true' == 'true') {
    stellar.plugins.swiper = Object.assign({"enable":true,"css":"https://unpkg.com/swiper@10.3/swiper-bundle.min.css","js":"https://unpkg.com/swiper@10.3/swiper-bundle.min.js"});
  }
  if ('' == 'true') {
    stellar.plugins.scrollreveal = Object.assign({"enable":null,"js":"https://gcore.jsdelivr.net/npm/scrollreveal@4.0.9/dist/scrollreveal.min.js","distance":"8px","duration":500,"interval":100,"scale":1});
  }
  if ('true' == 'true') {
    stellar.plugins.preload = Object.assign({"enable":true,"service":"flying_pages","instant_page":"https://gcore.jsdelivr.net/gh/volantis-x/cdn-volantis@4.1.2/js/instant_page.js","flying_pages":"https://gcore.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.fancybox = Object.assign({"enable":true,"js":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.umd.js","css":"https://gcore.jsdelivr.net/npm/@fancyapps/ui@4.0/dist/fancybox.css","selector":".fancybox img"});
  }
  if ('false' == 'true') {
    stellar.plugins.heti = Object.assign({"enable":false,"css":"https://unpkg.com/heti@0.9.2/umd/heti.min.css","js":"https://unpkg.com/heti@0.9.2/umd/heti-addon.min.js"});
  }
  if ('true' == 'true') {
    stellar.plugins.copycode = Object.assign({"enable":true,"js":"/js/plugins/copycode.js","default_text":"Copy","success_text":"Copied","toast":"复制成功"});
  }
</script>

<!-- required -->

  
<script src="/js/main.js" async></script>



<!-- optional -->

  <script>
    function load_twikoo() {
        if (!document.querySelectorAll("#twikoo_container")[0]) return;
        stellar.loadScript('https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js', {defer: true}).then(function () {
            const el = document.getElementById("twikoo_container");
            var path = el.getAttribute('comment_id');
            if (!path) {
                path = decodeURI(window.location.pathname);
            }
            twikoo.init(Object.assign({"js":"https://gcore.jsdelivr.net/npm/twikoo@1.6.8/dist/twikoo.all.min.js","envId":"https://twikooblogcomment-tkkws-projects-20e4cf59.vercel.app"}, {
                el: '#twikoo_container',
                path: path,
            }));
        });
    }

    window.addEventListener('DOMContentLoaded', (event) => {
        load_twikoo();
    });
</script>






<!-- inject -->


  </div>
</body>
</html>
